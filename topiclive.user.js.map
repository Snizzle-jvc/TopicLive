{"version":3,"sources":["header.js","node_modules/browser-pack/_prelude.js","src/Favicon.js","src/Formulaire.js","src/Message.js","src/Option.js","src/Page.js","src/TopicLive.js","src/index.js"],"names":[],"mappings":"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","file":"topiclive.user.js","sourcesContent":["// ==UserScript==\n// @name TopicLive\n// @description Charge les nouveaux messages d'un topic de JVC en direct\n// @author kiwec\n// @match http://www.jeuxvideo.com/*\n// @match http://m.jeuxvideo.com/*\n// @run-at document-end\n// @version 5.3.0-dev\n// @grant none\n// @noframes\n// ==/UserScript==\n","(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import TopicLive from './TopicLive.js';\n\n// Code de Spawnkill\nclass Favicon {\n  constructor() {\n    try {\n      this.init();\n    } catch(err) {\n      TopicLive.log(`### Erreur init favicon : ${err}`);\n    }\n  }\n\n  clear() {\n    this.context.clearRect(0, 0, this.canv.width, this.canv.height);\n    this.context.drawImage(this.image, 0, 0);\n  }\n\n  init() {\n    this.canv = $('<canvas>').get(0);\n    this.canv.width = 16;\n    this.canv.height = 16;\n    this.context = this.canv.getContext('2d');\n    this.image = new Image();\n    this.image.src = '/favicon.ico';\n\n    try { this.maj(''); }\n    catch(err) { TopicLive.log(`### Erreur favicon (init) : ${err}`); }\n  }\n\n  maj(txt) {\n    this.clear();\n\n    if(txt !== '')\n    {\n      this.context.fillStyle = 'red';\n      this.context.fillRect(0, 0, this.context.measureText(txt).width + 3, 11);\n      this.context.fillStyle = 'white';\n      this.context.font = 'bold 10px Verdana';\n      this.context.textBaseline = 'bottom';\n      this.context.fillText(txt, 1, 11);\n    }\n\n    this.replace();\n  }\n\n  replace() {\n    $('link[rel*=\"icon\"]').remove();\n    this.lien = $('<link>', {\n      href: this.canv.toDataURL('image/png'),\n      rel: 'shortcut icon',\n      type: 'image/png'\n    });\n    $('head').append(this.lien);\n  }\n}\n\nexport default Favicon;\n","import Page from './Page.js';\nimport TopicLive from './TopicLive.js';\n\nclass Formulaire {\n  constructor() {\n    // TopicLive.log('Nouveau formulaire.');\n    this.hook();\n  }\n\n  afficherErreurs(msg) {\n    if(typeof msg !== 'undefined') {\n      let message_erreur = '';\n      for(let i = 0; i < msg.length; i++) {\n        message_erreur += msg[i];\n        if(i < msg.length) message_erreur += '<br />';\n      }\n      TopicLive.alert(message_erreur);\n    }\n  }\n\n  envoyer(e) {\n    // Si le message est invalide selon JVC\n    if(typeof e !== 'undefined' && typeof e.errors !== 'undefined' && e.errors.length) {\n      this.afficherErreurs(e.erreurs);\n    } else {\n      TopicLive.log('Message valide. Envoi en cours');\n      this.trouver('.btn-poster-msg').attr('disabled', 'disabled');\n      this.trouver('.conteneur-editor').fadeOut();\n\n      window.clearTimeout(TopicLive.idanalyse);\n      $.ajax({\n        type: 'POST',\n        url: TopicLive.url,\n        data: this.obtenirFormulaire().serializeArray(),\n        timeout: 5000,\n        success: data => {\n          switch(typeof data) {\n            case 'object':\n              // MaJ du formulaire via JSON\n              if(data.hidden_reset) {\n                this.trouver('input[type=\"hidden\"]').remove();\n                this.obtenirFormulaire().append(data.hidden_reset);\n              }\n\n              // Erreur lors de l'envoi du message\n              if(data.errors) {\n                this.afficherErreurs(data.errors);\n                this.trouver('.btn-poster-msg').removeAttr('disabled');\n                this.trouver('.conteneur-editor').fadeIn();\n              }\n              \n              // Redirection via JSON (wtf)\n              if(data.redirect_uri) {\n                TopicLive.log(`Redirection du formulaire vers ${data.redirect_uri}`);\n                TopicLive.url = data.redirect_uri;\n                TopicLive.GET().then(() => this.verifEnvoi());\n              }\n              break;\n            case 'string':\n              this.verifEnvoi($(data.substring(data.indexOf('<!DOCTYPE html>'))));\n              break;\n            case 'undefined': /* falls through */\n            default:\n              TopicLive.alert('Erreur inconnue lors de l\\'envoi du message.');\n              this.trouver('.btn-poster-msg').removeAttr('disabled');\n              this.trouver('.conteneur-editor').fadeIn();\n              break;\n          }\n          \n          TopicLive.loop();\n        },\n        error: err => {\n          TopicLive.alert(`Erreur lors de l'envoi du message : ${err}`);\n        }\n      });\n    }\n  }\n\n  hook() {\n    // Remplacement du bouton de post\n    const $form = this.obtenirFormulaire();\n    const $bouton = $form.find('.btn-poster-msg');\n    $bouton.off();\n    $bouton.removeAttr('data-push');\n    $bouton.attr('type', 'button');\n    $bouton.on('click', () => this.verifMessage());\n  }\n\n  maj($nvform) {\n    TopicLive.log('Mise a jour du formulaire');\n    const $form = this.obtenirFormulaire();\n    const $cap = this.obtenirCaptcha($form);\n    const $ncap = this.obtenirCaptcha($nvform);\n\n    // Remplacement hashs formulaire\n    this.trouver('input[type=\"hidden\"]').remove();\n    $nvform.find('input[type=\"hidden\"]').each(function() {\n      $form.append($(this));\n    });\n\n    // Reactivation des boutons\n    this.trouver('.btn-poster-msg').removeAttr('disabled');\n    this.trouver('.conteneur-editor').fadeIn();\n\n    // Remplacement du captcha\n    $cap.remove();\n    this.trouver('.jv-editor').after($ncap);\n\n    // Maj banniere erreur\n    this.trouver('.alert-danger').remove();\n    this.trouver('.row:first').before($nvform.find('.alert-danger'));\n\n    // Remplacement du message (JVC n'effacera pas le message en erreur)\n    this.obtenirMessage().val(this.obtenirMessage($nvform).val());\n\n    this.hook();\n  }\n\n  obtenirCaptcha($form) {\n    if(typeof $form === 'undefined') $form = this.obtenirFormulaire();\n    return $form.find('.jv-editor').next('div');\n  }\n\n  obtenirMessage($form) {\n    if(typeof $form == 'undefined') $form = this.obtenirFormulaire();\n    return $form.find(TopicLive.estMP ? '#message' : '#message_topic');\n  }\n\n  obtenirFormulaire($page) {\n    if(typeof $page === 'undefined') $page = $(document);\n    return $page.find(TopicLive.estMP ? '#repondre-mp > form' : '.form-post-message');\n  }\n\n  verifEnvoi(data) {\n    const nvPage = new Page(data);\n    const $formu = this.obtenirFormulaire(nvPage.$page);\n    this.maj($formu);\n    TopicLive.majUrl(nvPage);\n    nvPage.scan();\n  }\n\n  verifMessage() {\n    TopicLive.log('Verification du message avant envoi');\n\n    if(TopicLive.estMP) {\n      this.envoyer();\n    } else {\n      $.ajax({\n        type: 'POST',\n        url: '/forums/ajax_check_poste_message.php',\n        data: {\n          id_topic, // global\n          new_message: this.obtenirMessage().val(),\n          ajax_timestamp: TopicLive.ajaxTs,\n          ajax_hash: TopicLive.ajaxHash\n        },\n        dataType: 'json',\n        timeout: 5000,\n        success: err => this.envoyer(err),\n        error: () => this.verifMessage()\n      });\n    }\n\n    return false;\n  }\n\n  trouver(chose) {\n    return this.obtenirFormulaire().find(chose);\n  }\n}\n\nexport default Formulaire;\n","import TopicLive from './TopicLive.js';\n\nclass Message {\n    constructor($message) {\n        if(TopicLive.estMP) {\n            this.id_message = 'MP';\n        } else if(TopicLive.mobile) {\n            let id = $message.attr('id');\n            id = id.slice(id.indexOf('_') + 1);\n            this.id_message = parseInt(id, 10);\n        } else {\n            this.id_message = parseInt($message.attr('data-id'), 10);\n        }\n\n        this.date = $(TopicLive.class_date, $message).text().replace(/[\\r\\n]|#[0-9]+$/g, '');\n        this.edition = $message.find('.info-edition-msg').text();\n        this.$message = $message;\n        this.pseudo = $('.bloc-pseudo-msg', $message).text().replace(/[\\r\\n]/g, '');\n        this.supprime = false;\n    }\n\n    afficher() {\n        TopicLive.log(`Affichage du message ${this.id_message}`);\n        this.$message.hide();\n        this.fixBlacklist();\n        this.fixCitation();\n      this.fixDeroulerCitation();\n      if(TopicLive.mobile) {\n        this.fixMobile();\n      }\n        $(`${TopicLive.class_msg}:last`).after(this.$message);\n        this.$message.fadeIn('slow');\n\n        dispatchEvent(new CustomEvent('topiclive:newmessage', {\n            'detail': {\n                id: this.id_message,\n                jvcake: TopicLive.jvCake\n            }\n        }));\n    }\n\n    fixBlacklist() {\n        this.trouver('.bloc-options-msg > .picto-msg-tronche, .msg-pseudo-blacklist .btn-blacklist-cancel').on('click', function () {\n            $.ajax({\n                url: '/forums/ajax_forum_blacklist.php',\n                data: {\n                    id_alias_msg: this.$message.attr('data-id-alias'),\n                    action: this.$message.attr('data-action'),\n                    ajax_hash: $('#ajax_hash_preference_user')\n                },\n                dataType: 'json',\n                success(e) {\n                    if(e.erreur && e.erreur.length) {\n              TopicLive.alert(e.erreur);\n                    } else {\n                        document.location.reload();\n                    }\n                }\n            });\n        });\n    }\n\n    fixCitation() {\n        TopicLive.log(`Obtention de la citation du message ${this.id_message}`);\n        this.$message.find('.bloc-options-msg .picto-msg-quote').on('click', () => {\n            $.ajax({\n                type: 'POST',\n                url: '/forums/ajax_citation.php',\n                data: {\n                    id_message: this.id_message,\n                    ajax_timestamp: TopicLive.ajaxTs,\n                    ajax_hash: TopicLive.ajaxHash\n                },\n                dataType: 'json',\n                timeout: 5000,\n                success: e => {\n                    TopicLive.log(`Citation du message ${this.id_message} recue avec succes`);\n                    const $msg = TopicLive.formu.obtenirMessage();\n                    let nvmsg = `> Le ${this.date} ${this.pseudo} a écrit :\\n>`;\n                    nvmsg += `${e.txt.split('\\n').join('\\n> ')}\\n\\n`;\n                    if($msg.val() === '') {\n                        $msg.val(nvmsg);\n                    } else {\n                        $msg.val(`${$msg.val()}\\n\\n${nvmsg}`);\n                    }\n                },\n                error: () => this.fixCitation()\n            });\n        });\n    }\n\n    fixDeroulerCitation() {\n      this.trouver('blockquote').click(function() {\n        $(this).attr('data-visible', '1');\n      });\n    }\n\n    fixMobile() {\n      this.trouver('.message').addClass('show-all');\n    }\n\n    trouver(chose) {\n        return this.$message.find(chose);\n    }\n\n    // Change le CSS du message pour indiquer qu'il est supprime\n    supprimer() {\n        TopicLive.log(`Alerte suppression du message ${this.id_message}`);\n        if(!this.supprime) {\n            this.trouver('.bloc-options-msg').hide();\n\n            // Clignotement du messages\n            this.$message.animate({\n                backgroundColor: '#3399FF'\n            }, 50);\n            this.$message.animate({\n                backgroundColor: '#D1F0FF'\n            }, 500);\n\n            this.supprime = true;\n        }\n    }\n\n    update(nvMessage) {\n        if(this.edition == nvMessage.edition) return;\n        TopicLive.log(`Message ${this.id_message} edite : mise a jour`);\n\n        this.edition = nvMessage.edition;\n        this.trouver(TopicLive.class_contenu).html(nvMessage.trouver(TopicLive.class_contenu).html());\n\n        dispatchEvent(new CustomEvent('topiclive:edition', {\n            'detail': {\n                id: this.id_message,\n                jvcake: TopicLive.jvCake\n            }\n        }));\n\n        // Clignotement du messages\n        const defColor = this.$message.css('backgroundColor');\n        this.$message.animate({\n            backgroundColor: '#FF9900'\n        }, 50);\n        this.$message.animate({\n            backgroundColor: defColor\n        }, 500);\n    }\n}\n\nexport default Message;\n","class TLOption {\n  constructor(nom, id) {\n    this.actif = localStorage[id] == 'true';\n    this.nom = nom;\n    this.id = id;\n\n    this.injecter();\n  }\n\n  injecter() {\n    // Ajout de l'option aux options JVC\n    let option = `<li><span class=\"pull-left\">TopicLive - ${this.nom}</span>`;\n    option += `<input type=\"checkbox\" class=\"input-on-off\" id=\"${this.id}\" `;\n    option += this.actif ? 'checked>' : '>';\n    option += `<label for=\"${this.id}\" class=\"btn-on-off\"></label></li>`;\n    $('.menu-user-forum').append(option);\n\n    // Register des events lors du toggle de l'option\n    this.bouton = $(`#${this.id}`);\n    this.bouton.change(() => {\n      this.actif = !this.actif;\n      localStorage[this.id] = this.actif;\n    });\n  }\n}\n\nexport default TLOption;\n","import Message from './Message.js';\nimport TopicLive from './TopicLive.js';\n\nclass Page {\n  constructor($page) {\n    // TopicLive.log('Nouvelle page.');\n    this.$page = $page;\n  }\n\n  obtenirMessages() {\n    // TopicLive.log('page.obtenirMessages()');\n    const msgs = [];\n    this.trouver(`${TopicLive.class_msg}:not(.msg-pseudo-blacklist)`).each(function() {\n      msgs.push(new Message($(this)));\n    });\n    return msgs;\n  }\n\n  // Appele quand il y a des nouveaux messages\n  maj() {\n    TopicLive.log('Nouveaux messages ! Execution favicon/son/spoilers');\n    if(localStorage.topiclive_son == 'true') {\n      try { TopicLive.son.play(); }\n      catch(err) { TopicLive.log(`### Erreur son : ${err}`); }\n    }\n    try { if(!TopicLive.ongletActif) TopicLive.favicon.maj(`${TopicLive.nvxMessages}`); }\n    catch(err) { TopicLive.log(`### Erreur favicon (maj) : ${err}`); }\n    try { this.Transformation(); }\n    catch(err) { TopicLive.log(`### Erreur jsli.Transformation() : ${err}`); }\n\n    // Nettoyage des anciens messages\n    const nb_messages = $(`${TopicLive.class_msg}:not(.msg-pseudo-blacklist)`).size();\n    if(nb_messages > 100) {\n      $(`${TopicLive.class_msg}:not(.msg-pseudo-blacklist)`)\n      .slice(0, nb_messages - 100)\n      .remove();\n    }\n\n    TopicLive.log('Envoi de topiclive:doneprocessing');\n    dispatchEvent(new CustomEvent('topiclive:doneprocessing', {\n      'detail': { jvcake: TopicLive.jvCake }\n    }));\n  }\n\n  scan() {\n    // TopicLive.log('Scan de la page');\n    TopicLive.ajaxTs = this.trouver('#ajax_timestamp_liste_messages').val();\n    TopicLive.ajaxHash = this.trouver('#ajax_hash_liste_messages').val();\n\n    // Maj du nombre de connectes\n    $('.nb-connect-fofo').text(this.trouver('.nb-connect-fofo').text());\n\n    if($(TopicLive.class_msg).length === 0 || $(TopicLive.class_page_fin).length !== 0) {\n      TopicLive.log('Pas sur une derniere page : loop');\n      TopicLive.majUrl(this);\n      TopicLive.loop();\n      return;\n    }\n\n    let maj = false;\n\n    // Liste de messages\n    const nvMsgs = this.obtenirMessages();\n    const anciensMsgs = TopicLive.messages;\n\n    // TopicLive.log('Verification des messages supprimes');\n    try {\n    if(!TopicLive.estMP) {\n      for(const i in anciensMsgs) {\n        if(!anciensMsgs.hasOwnProperty(i)) continue; // fix chrome\n        let supprimer = true;\n        for(const j in nvMsgs) {\n          if(!nvMsgs.hasOwnProperty(j)) continue; // fix chrome\n          if(anciensMsgs[i].id_message == nvMsgs[j].id_message) {\n            supprimer = false;\n            break;\n          }\n        }\n        if(supprimer) TopicLive.messages[i].supprimer();\n      }\n    }\n    } catch(err) { TopicLive.log(`### Erreur messages supprimes : ${err}`); }\n\n    // TopicLive.log('Verification des nouveaux messages et editions');\n    try {\n    for(const k in nvMsgs) {\n      if(!nvMsgs.hasOwnProperty(k)) continue; // fix chrome\n      let nv = true;\n      for(const l in anciensMsgs) {\n        if(!anciensMsgs.hasOwnProperty(l)) continue; // fix chrome\n        if(TopicLive.estMP) {\n          if(anciensMsgs[l].trouver('.bloc-spoil-jv').length !== 0) {\n            const ancienneDate = anciensMsgs[l].trouver(TopicLive.class_date).text();\n          const nouvelleDate = nvMsgs[k].trouver(TopicLive.class_date).text();\n          if(ancienneDate == nouvelleDate) {\n              nv = false;\n              break;\n            }\n          } else if(anciensMsgs[l].$message.text() == nvMsgs[k].$message.text()) {\n            nv = false;\n            break;\n          }\n        } else {\n          if(anciensMsgs[l].id_message == nvMsgs[k].id_message) {\n            nv = false;\n            anciensMsgs[l].update(nvMsgs[k]);\n            break;\n          }\n        }\n      }\n      if(nv) {\n        // TopicLive.log('Nouveau message !');\n        TopicLive.messages.push(nvMsgs[k]);\n        TopicLive.nvxMessages++;\n        nvMsgs[k].afficher();\n        maj = true;\n      }\n    }\n    } catch(err) { TopicLive.log(`Erreur nouveaux messages : ${err}`); }\n\n    // Doit etre avant TopicLive.charger()\n    TopicLive.majUrl(this);\n\n    if(maj) {\n      this.maj();\n    }\n\n    TopicLive.loop();\n  }\n\n  // Version perso de JvCare\n  Transformation() {\n    $('.JvCare').each(function () {\n      const $span = $(this);\n      let classes = $span.attr('class');\n      const href = TopicLive.jvCake(classes);\n\n      // Suppression de JvCare\n      classes = classes.split(' ');\n      const index = classes.indexOf('JvCare');\n      classes.splice(index, index + 2);\n      classes.unshift('xXx');\n      classes = classes.join(' ');\n\n      $span.replaceWith(`<a href=\"${href}\" class=\"${classes}\">${$span.html()}</a>`);\n    });\n\n    // Fix temporaire des avatars\n    $('.user-avatar-msg').each(function () {\n      const $elem = $(this);\n      const newsrc = $elem.attr('data-srcset');\n      if(newsrc != 'undefined') {\n        $elem.attr('src', newsrc);\n        $elem.removeAttr('data-srcset');\n      }\n    });\n  }\n\n  trouver(chose) {\n    // TopicLive.log('Page.trouver : ' + chose);\n    return this.$page.find(chose);\n  }\n}\n\nexport default Page;\n","import Favicon from './Favicon.js'\nimport Formulaire from './Formulaire.js'\nimport Page from './Page.js'\nimport TLOption from './Option.js'\n\nclass TopicLive {\n  constructor() {\n    this.log('Initialisation');\n    this.instance = 0;\n    this.ongletActif = true;\n    this.favicon = new Favicon();\n    this.son = new Audio('https://raw.githubusercontent.com/Kiwec/TopicLive/master/notification.ogg');\n\n    this.suivreOnglets();\n    this.init();\n    addEventListener('instantclick:newpage', () => this.init());\n\n    $(\"head\").append(\"<style type='text/css'>\\\n        .topiclive-loading:after { content: ' ○' }\\\n        .topiclive-loaded:after { content: ' ●' }\\\n      </style>\");\n  }\n\n  ajouterOptions() {\n    if(this.mobile) return;\n    this.options = {\n      optionSon: new TLOption('Son', 'topiclive_son')\n    };\n  }\n\n  charger() {\n    if(this.oldInstance != this.instance) {\n      this.log('Nouvelle instance detectee : arret du chargement');\n      return;\n    }\n    \n    this.GET().then(data => new Page(data).scan());\n  }\n\n  // Sera initialise a chaque changement de page\n  init() {\n    if(typeof $ === 'undefined') {\n      return this.log('### jQuery introuvable !');\n    }\n\n    this.instance++;\n    this.ajaxTs = $('#ajax_timestamp_liste_messages').val();\n    this.ajaxHash = $('#ajax_hash_liste_messages').val();\n    this.estMP = $('.mp-page').length;\n    this.url = this.estMP ? document.URL.substring(0, document.URL.indexOf('&')) : document.URL;\n    this.mobile = document.URL.includes('//m.jeuxvideo.com');\n\n    this.class_msg = this.mobile ? '.post' : '.bloc-message-forum';\n    this.class_num_page = this.mobile ? '.num-page' : '.page-active';\n    this.class_page_fin = this.mobile ? '.right-elt > a' : '.pagi-fin-actif';\n    this.class_date = this.mobile ? '.date-post' : '.bloc-date-msg';\n    this.class_contenu = this.mobile ? '.contenu' : '.bloc-contenu';\n\n    this.ajouterOptions();\n\n    // Actif sur les URL de forums ou de messages privés, tant qu'il y a un\n    // message dans la page.\n    // -> Sera compatible respeed, sans pour autant s'exécuter sur des pages\n    //    non supportées (ex. GTA)\n    const analysable = (document.URL.match(/\\/forums\\//) || document.URL.match(/\\/messages-prives\\//));\n    if(analysable && $(this.class_msg).length > 0) {\n      this.log('TopicLive actif sur cette page.');\n      this.page = new Page($(document));\n      this.formu = new Formulaire();\n      this.messages = this.page.obtenirMessages();\n      this.nvxMessages = 0;\n      this.page.scan();\n      this.loop();\n    } else {\n      this.log('TopicLive sera inactif sur cette page');\n    }\n  }\n\n  // Transforme une classe chiffree par JvCare en un lien\n  jvCake(classe) {\n    const base16 = '0A12B34C56D78E9F';\n    let lien = '';\n    const s = classe.split(' ')[1];\n    for (let i = 0; i < s.length; i += 2) {\n      lien += String.fromCharCode(base16.indexOf(s.charAt(i)) * 16 + base16.indexOf(s.charAt(i + 1)));\n    }\n    return lien;\n  }\n\n  alert(message) {\n    try {\n      modal('erreur', { message });\n      this.log(message);\n    } catch(err) {\n      this.log('### Fonction modal() inaccessible');\n      alert(message);\n    }\n  }\n\n  log(message) {\n    console.log(`[TopicLive] ${message}`);\n  }\n\n  loop() {\n    if(typeof this.idanalyse !== 'undefined') window.clearTimeout(this.idanalyse);\n\n    let duree = this.ongletActif ? 5000 : 10000;\n\n    if(this.mobile)\n      duree = 10000;\n\n    this.oldInstance = this.instance;\n    this.idanalyse = setTimeout(() => this.charger(), duree);\n  }\n\n  majUrl(page) {\n    if(this.estMP) return;\n\n    const $bouton = page.trouver(this.class_page_fin);\n    const numPage = page.trouver(`${this.class_num_page}:first`).text();\n    const testUrl = this.url.split('-');\n\n    // Si le bouton page suivante est present\n    if($bouton.length > 0) {\n      this.log('Nouvelle URL (loop)');\n      this.messages = [];\n      if($bouton.prop('tagName') == 'A') {\n        this.url = $bouton.attr('href');\n      } else {\n        this.url = this.jvCake($bouton.attr('class'));\n      }\n      // Si la page n'est pas la meme (ex. post d'un message sur nouvelle page)\n    } else if(testUrl[3] != numPage) {\n      this.log('Nouvelle URL (formulaire)');\n      this.messages = [];\n      testUrl[3] = numPage;\n      this.url = testUrl.join('-');\n    }\n  }\n\n  suivreOnglets() {\n    $(window).bind('focus', () => {\n      if(!this.ongletActif) {\n        this.ongletActif = true;\n        this.favicon.maj('');\n        this.nvxMessages = 0;\n      }\n    });\n    $(window).bind('blur', () => {\n      if(this.ongletActif) {\n        this.ongletActif = false;\n        this.favicon.maj('');\n        this.nvxMessages = 0;\n      }\n    });\n  }\n\n  GET() {\n    const blocChargement = this.mobile ? $('.bloc-nom-sujet:last > span') : $('#bloc-formulaire-forum .titre-bloc');\n    blocChargement.addClass('topiclive-loading');\n    \n    window.clearTimeout(this.idanalyse);\n    return new Promise((resolve, reject) => {\n      $.ajax({\n        type: 'GET',\n        url: this.url,\n        timeout: 5000,\n        success: data => {\n          if(this.oldInstance != this.instance) {\n            this.log('Nouvelle instance detectee : arret du chargement');\n            return;\n          }\n      \n          blocChargement.removeClass('topiclive-loading');\n          blocChargement.addClass('topiclive-loaded');\n          resolve($(data.substring(data.indexOf('<!DOCTYPE html>'))));\n          setTimeout(() => { blocChargement.removeClass('topiclive-loaded'); }, 100);\n          \n          this.loop();\n        },\n        error() {\n          this.loop();\n          reject();\n        }\n      });\n    });\n  }\n}\n\nexport default new TopicLive();\n","import TopicLive from './TopicLive.js';\nTopicLive.log('TopicLive initialisé !');\n"]}